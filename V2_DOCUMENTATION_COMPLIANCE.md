# V2 Documentation Compliance Guide (CLAUDE.md Requirements)

## Overview

This document ensures all consolidated V2 modules meet the **mandatory documentation requirements** specified in CLAUDE.md. Every function, type, and workflow must be documented according to these standards before code acceptance.

## CLAUDE.md Documentation Requirements

### **Mandatory Documentation Standards**

**From CLAUDE.md Section: Documentation Requirements**

> "Each function MUST include doxygen-style comments"

**Required Format**:
```vba
' **Purpose**: Brief description of what function does
' **Parameters**:
'   - paramName (Type): Description
' **Returns**: Type and description of return value
' **Dependencies**: List of called functions/modules
' **Side Effects**: Files created, sheets modified, etc.
' **Errors**: Error handling approach
```

### **Absolute Requirements (CLAUDE.md)**

1. **Function Signatures**: All public functions documented with parameters and return types
2. **Data Structures**: All Type definitions documented with field purposes
3. **Excel Schema**: Sheet structures with column mappings and business rules
4. **Workflow Maps**: Business process flows maintained with function call chains
5. **Field Mappings**: Cross-reference of all data fields used across sheets
6. **Error Codes**: All error handling patterns documented with recovery steps

## Module-by-Module Documentation Requirements

### **1. CoreFramework.bas Documentation**

#### **Required Function Documentation Template**:
```vba
' **Purpose**: Get current Windows username with 32-bit compatibility
' **Parameters**: None
' **Returns**: String - Current Windows username, empty string if error
' **Dependencies**: Windows API GetUserNameA from advapi32.dll
' **Side Effects**: None
' **Errors**: Returns empty string on API failure, logs error via LogError()
Public Function GetCurrentUser() As String
```

#### **Required Type Documentation Template**:
```vba
' **Purpose**: Complete enquiry information structure for PCS system
' **CLAUDE.md Compliance**: Maintains all legacy enquiry fields for compatibility
Public Type EnquiryData
    ' **Purpose**: Unique enquiry identifier in E00001 format
    ' **Dependencies**: Generated by NumberGenerator.GetNextEnquiryNumber()
    EnquiryNumber As String

    ' **Purpose**: Customer company name for business identification
    ' **Side Effects**: Used in search database, customer file creation
    CustomerName As String

    ' **Purpose**: Primary contact person at customer company
    ContactPerson As String

    ' **Purpose**: Customer company phone number
    CompanyPhone As String

    ' **Purpose**: Customer company fax number (legacy compatibility)
    CompanyFax As String

    ' **Purpose**: Customer email address for communication
    Email As String

    ' **Purpose**: Description of component being enquired about
    ' **Dependencies**: Used in search keywords, quote generation
    ComponentDescription As String

    ' **Purpose**: Internal component code if available
    ComponentCode As String

    ' **Purpose**: Material grade specification for component
    MaterialGrade As String

    ' **Purpose**: Quantity of components requested
    ' **Errors**: Must be > 0, validated by ValidateEnquiryData()
    Quantity As Long

    ' **Purpose**: Date enquiry was created
    ' **Side Effects**: Used for search sorting, archival decisions
    DateCreated As Date

    ' **Purpose**: Full path to enquiry Excel file
    ' **Dependencies**: Generated by DataManager file operations
    FilePath As String

    ' **Purpose**: Searchable keywords for enquiry
    ' **Dependencies**: Used by SearchManager for record finding
    SearchKeywords As String
End Type
```

### **2. DataManager.bas Documentation**

#### **File Operation Functions**:
```vba
' **Purpose**: Safely open Excel workbook with error handling and validation
' **Parameters**:
'   - FilePath (String): Full path to Excel file to open
' **Returns**: Workbook object if successful, Nothing if failed
' **Dependencies**: CoreFramework.ErrorHandler for error logging
' **Side Effects**: Opens workbook in Excel application, logs errors if failed
' **Errors**: Returns Nothing on file not found, permission denied, or corruption
' **CLAUDE.md Compliance**: Maintains 32/64-bit Excel compatibility
Public Function SafeOpenWorkbook(ByVal FilePath As String) As Workbook
```

#### **Directory Structure Functions**:
```vba
' **Purpose**: Validate all required PCS directory structure exists
' **Parameters**: None
' **Returns**: Boolean - True if all directories exist, False if any missing
' **Dependencies**:
'   - CoreFramework.ErrorHandler for logging
'   - DirExists() for individual directory checking
' **Side Effects**: Logs missing directories to error log
' **Errors**: Logs each missing directory, does not create directories
' **CLAUDE.md Compliance**: Preserves existing directory structure, no changes made
Public Function ValidateDirectoryStructure() As Boolean
```

### **3. SearchManager.bas Documentation**

#### **Search Functions**:
```vba
' **Purpose**: Search all PCS records with optimization for recent files
' **Parameters**:
'   - SearchTerm (String): Text to search for in records
'   - RecordTypeFilter (RecordType, Optional): Limit search to specific record type
' **Returns**: Variant array of SearchRecord objects, empty array if no matches
' **Dependencies**:
'   - DataManager.SafeOpenWorkbook for database access
'   - CoreFramework.ErrorHandler for error logging
' **Side Effects**:
'   - Updates search history database
'   - Sorts search database by date (recent files first)
' **Errors**: Returns empty array on database access failure
' **CLAUDE.md Compliance**: Maintains "finds anything in the system" requirement
Public Function SearchRecords_Optimized(ByVal SearchTerm As String, _
                                       Optional ByVal RecordTypeFilter As RecordType = 0) As Variant
```

### **4. BusinessController.bas Documentation**

#### **Workflow Functions**:
```vba
' **Purpose**: Create new enquiry following PCS business rules
' **Parameters**:
'   - EnquiryInfo (EnquiryData): Complete enquiry information structure
' **Returns**: Boolean - True if enquiry created successfully, False if failed
' **Dependencies**:
'   - DataManager.SafeOpenWorkbook for template access
'   - NumberGenerator.GetNextEnquiryNumber for unique ID
'   - SearchManager.UpdateSearchDatabase for search integration
' **Side Effects**:
'   - Creates new enquiry Excel file in Enquiries directory
'   - Updates search database with new record
'   - Increments enquiry number sequence
' **Errors**: Returns False on template missing, file creation failure, or validation errors
' **CLAUDE.md Compliance**: Maintains Enquiry → Quote → Jobs workflow
Public Function CreateNewEnquiry(ByRef EnquiryInfo As EnquiryData) As Boolean
```

### **5. InterfaceManager.bas Documentation**

#### **System Management Functions**:
```vba
' **Purpose**: Initialize PCS application and validate system readiness
' **Parameters**: None
' **Returns**: Boolean - True if initialization successful, False if critical failure
' **Dependencies**:
'   - CoreFramework.ValidateSystemRequirements for system validation
'   - DataManager.ValidateDirectoryStructure for file system validation
'   - All controller modules for business system validation
' **Side Effects**:
'   - Validates all system components
'   - Logs system status to error log
'   - May display user messages for critical failures
' **Errors**: Returns False on system validation failure, logs all issues
' **CLAUDE.md Compliance**: Preserves all existing system integrations
Public Function InitializeApplication() As Boolean
```

## Workflow Documentation Requirements

### **Enquiry → Quote → Jobs Workflow (CLAUDE.md Requirement)**

**Process Flow Documentation**:
```
1. Enquiry Creation:
   - BusinessController.CreateNewEnquiry()
   - DataManager.GetNextEnquiryNumber()
   - SearchManager.UpdateSearchDatabase()

2. Quote Generation:
   - BusinessController.CreateQuoteFromEnquiry()
   - DataManager.GetNextQuoteNumber()
   - SearchManager.UpdateSearchDatabase()

3. Job Creation:
   - BusinessController.CreateJobFromQuote()
   - DataManager.GetNextJobNumber()
   - SearchManager.UpdateSearchDatabase()
```

### **Jobs → Job Cards → WIP Reports Workflow (CLAUDE.md Requirement)**

**Process Flow Documentation**:
```
1. Job Creation:
   - BusinessController.CreateJobFromQuote()
   - WIP Status: "New Job"

2. Job Card Generation:
   - BusinessController.GenerateJobCard()
   - WIP Status: "In Progress"

3. WIP Reporting:
   - BusinessController.SaveWIPData()
   - BusinessController.GenerateWIPReport()
```

## Error Documentation Standards

### **Error Handling Pattern Documentation**:
```vba
' **Error Pattern**: File Not Found (ERR_FILE_NOT_FOUND = 53)
' **Recovery Steps**:
'   1. Log error with full file path
'   2. Display user-friendly message
'   3. Offer alternative actions (browse for file, create new)
'   4. Return appropriate failure indicator
' **User Impact**: Function fails gracefully, user can retry or choose alternative
' **System Impact**: No data corruption, system remains stable
```

## Documentation Verification Checklist

### **Before Code Acceptance (CLAUDE.md Requirements)**:

- [ ] **All public functions documented** with doxygen-style comments
- [ ] **All Type definitions documented** with field purposes
- [ ] **All parameters documented** with types and descriptions
- [ ] **All return values documented** with types and meaning
- [ ] **All dependencies listed** (called functions/modules)
- [ ] **All side effects documented** (files created, sheets modified)
- [ ] **All error handling documented** with recovery steps
- [ ] **Workflow changes mapped** in process documentation
- [ ] **Excel schema changes reflected** in documentation

### **Documentation Completeness Validation**:

1. **Function Signature Coverage**: Every public function has complete documentation
2. **Data Structure Coverage**: Every Type and Enum fully documented
3. **Error Pattern Coverage**: All error scenarios have documented recovery steps
4. **Workflow Coverage**: All business processes mapped with function call chains
5. **Integration Coverage**: All module dependencies documented

## Documentation Update Triggers (CLAUDE.md)

**WHEN Documentation MUST be updated**:
- Adding new functions or subroutines → Update function documentation immediately
- Modifying function parameters or return values → Update parameter documentation
- Changing business logic or workflows → Update workflow documentation
- Adding or removing Excel sheet columns/fields → Update schema documentation
- Modifying data structures or types → Update type documentation
- Changing file paths or directory interactions → Update dependency documentation
- Updating error handling patterns → Update error documentation

## Documentation Debt Prevention

**CLAUDE.md Requirement**: "Never commit code without corresponding documentation updates"

**Prevention Strategy**:
1. **Document while coding** - Write documentation as functions are created
2. **Peer review documentation** - Ensure completeness before acceptance
3. **Validation scripts** - Automated checks for missing documentation
4. **Documentation blockers** - Code acceptance requires documentation completeness

This documentation compliance ensures the consolidated V2 modules meet all CLAUDE.md requirements while providing comprehensive reference material for system maintenance and enhancement.